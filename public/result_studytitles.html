<!DOCTYPE html>
<html lang="en">

<head>
  <title>Titles of Study</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- These belongs to the HTML file where you want C3 to work - put these lines into your <head> tag -->
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/c3/0.1.29/c3.js"></script>
  <link href="//cdnjs.cloudflare.com/ajax/libs/c3/0.1.29/c3.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
</head>

<body onload="init()">
  <nav class="navbar navbar-default">
    <ul class="nav navbar-nav">
      <li><a href="#" onclick='showChart(0)'>Forza Italia</a></li>
      <li><a href="#" onclick='showChart(1)'>Fratelli D'Italia</a></li>
      <li><a href="#" onclick='showChart(2)'>Movimento 5 Stelle</a></li>
      <li><a href="#" onclick='showChart(3)'>Lega</a></li>
      <li><a href="#" onclick='showChart(4)'>Partito Democratico</a></li>
    
    </ul>
  </nav>
  <h1>Livello di istruzione relativo ai singoli partiti (anno 2019)</h1>


  <script>
    function init() {
      var httpReq = new XMLHttpRequest();
      httpReq.open("GET", "/datasetQuery5", false);
      httpReq.send();
      if (httpReq.status == 200) {
        localStorage.setItem("results", httpReq.response);
      }
      showChart(0);
    }

    function showChart(index) {

      var results = JSON.parse(localStorage.getItem("results"));
      console.log(results)
      var iDiv = document.createElement('div');
      iDiv.id = 'chart';
      document.getElementsByTagName('body')[0].appendChild(iDiv);
      var chart = c3.generate({
        data: {
          columns: [
            ['Lic_Elementare', results[index].licenzaelementare],
            ['Lic_Media_Inf', results[index].licenzamediainf],
            ['Lic_Media_Sup', results[index].licenzamediasup],
            ['Laurea', results[index].laurea],
            ['Dottorato', results[index].dottorato]
          ],
          type: 'donut'
        },
        donut: {
          expand: true,
          title: results[index]._id
        }
      });

      chart.resize({ height: 800, width: 800 })
    }      
  </script>
</body>

</html>